<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>3RDEYESYSTEM Technical Documentations</title>
        <description>써드아이시스템(3rdeyesys) 기술문서 사이트입니다 - Ncloud 프리미엄 파트너</description>
        <link>https://docs.3rdeyesys.com/</link>
        <atom:link href="https://docs.3rdeyesys.com/feed.xml" rel="self" type="application/rss+xml"/>
        <pubDate>Wed, 26 Jul 2023 14:46:56 +0900</pubDate>
        <lastBuildDate>Wed, 26 Jul 2023 14:46:56 +0900</lastBuildDate>
        <generator>Jekyll v4.2.2</generator>
        
        
        <item>
            <title>VPC 환경에서 SSL VPN 설정하고 접속하는 방법</title>
            <description>## 개요
Ncloud(네이버 클라우드) 외부에서 내부에 구성된 네트워크로 암호화된 보안 접속 통신을 제공하는 서비스인 SSL VPN을 VPC 환경에서 설정하고, 서버에 접속하는 방법에 대해 정리해보겠습니다.

## SSL VPN이란?
- VPN은 가상 사설망(Virtual Private Network)의 약자로, 외부에서 접근할 수 없는 사설망에 내 PC나 네트워크를 연결시키는 방법을 말합니다.
- 사설망과의 연결은 가상 터널을 통해 이루어지며, 이 가상 터널을 SSL 암호화로 보호하는 것이 SSL VPN입니다.
- 가상 터널을 통해 사설망과 연결된 사용자 PC는 사설망의 라우팅 및 ACL 정책에 따라 내부 서버에 접근할 수 있습니다.

## SSL VPN 서비스 위치
Ncloud 콘솔에서 SSL VPN의 위치는 [**Services**] - [**Security**] - [**SSL VPN**]에 있습니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-01.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

## SSL VPN 생성
[**SSL VPN 생성**] 버튼을 클릭합니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-02.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

우선 접근할 서버가 속해 있는 VPC를 선택하고, 등록 가능한 접속 ID 개수에 따른 상품을 선택합니다.  
VPC 환경에서는 3, 5, 10, 20, 30, 50, 100, 200, 300, 400, 500개 상품 중에서 선택 가능합니다. 

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-03.png&quot; width=&quot;685&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

VPC 환경의 SSL VPN은 콘솔에서 자동으로 생성하는 것이 아니라 `생성 요청을 하면 Ncloud 담당자가 직접 생성하고 결과를 안내 받는 구조`로 되어 있습니다. 
생성 완료까지 걸리는 시간은 **약 10~20분 이내** 이며, 생성이 완료되면 SSL VPN 상태가 [운영중]으로 변경되고, 안내 메일이 도착합니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-04.png&quot; width=&quot;485&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

## SSL VPN 생성 완료 {#connection-url-check}
SSL VPN 생성이 완료되면 아래와 같이 [**IP POOL**]과 [**접속 URL**] 정보를 확인할 수 있는데 SSL VPN Agent 접속 시에 중요한 정보이니 잘 확인해야 합니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-05.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}


## 사용자 설정
SSL VPN에 접속할 사용자 정보를 설정합니다.  리스트에서 SSL VPN을 선택하고 [사용자 설정] 버튼을 클릭합니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-06.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

사용자 정보는 ID, Passowrd, Email, SMS 등을 입력하고 [**추가**] 버튼을 클릭합니다.  
VPC 환경은 이차인증이 필수이므로  SMS와 Email 정보를 함께 입력합니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-07.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

사용자가 추가되면 SSL VPN 정보에 사용자 계정 수(등록된 ID 수)에 숫자가 표시되는 것을 확인할 수 있습니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-08.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

## Route Table 설정
네트워크 설정에서는 우선 접속할 서버가 속해 있는 VPC Subnet의 Route Table에 SSL VPN으로 접근할 수 있게 SSL VPN의 [**IP POOL**]을 등록해야 합니다.  

- **접속할 서버 정보 확인**  
아래와 같이 접속할 서버의 정보에서 VPC와 Subnet을 확인합니다. 여기서는 Private Subnet에 생성한 서버에 접속할 예정입니다. 

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-09.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

### VPC 서비스 위치
[**VPC**] 서비스는 [**Console**] - [**Services**] - [**Networking**]에 위치해 있습니다.  
그리고, 아래와 같이 [**VPC Management**], [**Subnet Management**], [**Route Table**] 메뉴를 확인할 수 있습니다.

{% include image.html file=&quot;networking/ncloud-networking-vpc-subnet-create-01.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 VPC, Subnet 생성&quot; caption=&quot;&quot; %}

[**VPC**] - [**Route Table**]에서 해당 VPC의 Private Subnet을 선택하고 [**Routes 설정**] 버튼을 클릭합니다.  
(Public Subnet에 생성한 서버에 접근해야 할 경우에는 public-table을 선택하고 설정하시면 됩니다.)

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-10.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

[**Destination**]에 생성된 SSL VPN 정보에서 확인한 [**IP POOL**] 정보를 등록하고, [**Target Type**]은 SSLVPN을 선택, [**Target Name**]은 위에서 생성한 SSL VPN 이름을 선택하고 [생성] 버튼을 클릭합니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-11.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

## ACG 설정
다음으로 서버에 적용된 ACG에 SSL VPN의 [**IP POOL**]을 등록해야 합니다.  
우선 SSL VPN을 통해서 접속할 서버를 선택하고 [**ACG 수정**] 버튼을 클릭해서 적용된 ACG를 확인합니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-12.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

ACG 수정 화면에서 현재 적용된 ACG 이름을 확인할 수 있습니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-13.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

[**Server**] - [**ACG**]에서 위에서 확인한 ACG를 선택하고 [ACG 설정]을 클릭합니다. 

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-14.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

ACG 규칙 설정 화면에서 위에서 확인했던 [**IP POOL**]을 접근 소스에 입력하고, 필요한 포트들을 등록합니다. 
기본이 되는 프로토콜과 포트는 리눅스 서버 접속용 TCP 22, 윈도우 서버 접속용 TCP 3389, Ping 확인용 ICMP 등입니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-15.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}


## Agent 다운로드
SSL VPN 접속을 위한 Agent를 다운로드 합니다.  

- &lt;a href=&quot;https://guide.ncloud-docs.com/docs/sslvpn-download&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;SSL VPN Agent 다운로드&lt;/a&gt;

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-16.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

## Agent 접속
Agent 프로그램, BIG-IP Edge Client를 설치하고 실행하면 다음과 같은 화면을 볼 수 있습니다. 
서버 선택 창에 위에서 생성했던 SSL VPN 정보에서 확인했던 [**접속 URL**] 주소를 입력하고, [다음] 버튼을 클릭합니다.

{% include tip.html content=&quot;
[접속 URL 확인하는 방법 &lt;i class=&apos;fa-solid fa-arrow-up-from-bracket&apos;&gt;&lt;/i&gt;](#connection-url-check)&lt;br /&gt;
&quot; %}

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-17.png&quot; width=&quot;557&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

주소 변경 후에 [연결] 버튼을 클릭하면 로그인 화면이 나타나는데 위에서 설정했던 VPN 접속용 아이디와 Password를 입력하고 [로그온] 버튼을 클릭합니다. 

{% include image.html file=&quot;security/ncp_security_ssl_vpn_vpc_guide_20.png&quot; width=&quot;650&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

그리고 도착한 OTP 인증 번호를 입력합니다. 

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-18.png&quot; width=&quot;710&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

SSL VPN에 제대로 연결이 되었는지 확인하기 위해서 cmd 창을 띄워서 ipconfig 명령어를 입력하면 아래 화면처럼 SSL VPN 주소로 설정된 어탭터에  [**IP POOL**]에 해당하는 IP가 할당된 것을 확인할 수 있습니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-19.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}


## 서버 접속
이제 SSL VPN이 연결된 상태에서 서버에 접속해보겠습니다.  
PuTTY 를 실행하고 접속할 서버의 IP를 입력합니다.  
이때 서버 IP는 콘솔에 있는 서버 정보에서 **비공인 IP**에 표시되는 IP를 입력하면 됩니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-20.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}


## Agent 기타 설정
SSL VPN Agent에는 몇가지 추가 기능이 있는데 아래에서 확인해보겠습니다.

### 트래픽 그래프
Agent 창에서 [그래프 보기] 버튼을 클릭합니다. 

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-21.png&quot; width=&quot;557&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}


여기서는 SSL VPN이 연결된 상태의 트래픽을 그래프로 확인할 수 있습니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-22.png&quot; width=&quot;557&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}


다음으로 [상세 보기] 버튼을 클릭하면 접속 세부 정보, 로그, 통계, 알림, 라우팅 테이블, IP설정 등의 정보를 확인할 수 있습니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-23.png&quot; width=&quot;777&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}



## 설정 변경
처음에 설정한 접속 가능 ID 개수를 변경하고 싶을 경우 SSL VPN을 선택하고 [SSL VPN 설정 변경] 버튼을 클릭합니다. 

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-24.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

### ID 개수 변경
3, 5, 10, 20, 30, 50, 100, 200, 300, 400, 500개 상품 중에서 원하는 개수로 변경할 수 있습니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-25.png&quot; width=&quot;685&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

### 인증 로그 수집
Ncloud SSN VPN은 이용자가 SSN VPN에 접속 인증한 로그를 수집할 수 있습니다. [**설정**] 버튼을 클릭합니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-26.png&quot; width=&quot;685&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

인증 로그 수집을 활성화 하면 [**Cloud Log Analytics**]에 로그를 전달하여 저장합니다. 해당 상품을 미사용중이면 Cloud Log Analytics 상품 이용 신청을 한 후에 사용하시면 됩니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-27.png&quot; width=&quot;685&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

- Cloud Log Analytics에서 인증 로그 확인
{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-30.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}


## 주의사항
{% include warning.html title=&quot;접속 오류&quot; content=&quot;SSL VPN이 연결된 상태에서 새로운 서버를 생성하고 접속을 시도하면 아래와 같은 오류 메시지가 뜨면서 서버 접속이 되지 않습니다.  이때는 SSL VPN의 연결을 끊었다가 다시 연결해야 새로 생성한 서버에 접속할 수 있습니다.&quot; %}

{% include image.html file=&quot;security/ncp_security_ssl_vpn_classic_guide_23.png&quot; width=&quot;700&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}


## 삭제
삭제를 원할 경우 SSL VPN을 선택하고 상단의 [삭제] 버튼을 클릭합니다. 

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-28.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

하지만, 바로 삭제가 되지 않고 다음과 같이 &quot;Route Table에서 Target으로 지정된 Route 정보를 모두 삭제해야 삭제가 가능합니다&quot;라는 메시지가 뜹니다. 

{% include image.html file=&quot;security/ncp_security_ssl_vpn_vpc_guide_30.png&quot; width=&quot;500&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

[VPC] - [Route Table]에서 해당 VPC의 Private Subnet을 선택하고 [Routes 설정] 버튼을 클릭해서 등록된 설정을 확인하고 [X] 버튼을 클릭해서 설정을 삭제합니다. 
Route Table 정보를 삭제한 후에 SSL VPN을 삭제하시면 됩니다.

{% include image.html file=&quot;security/ncloud-security-ssl-vpn-vpc-guide-29.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드) VPC 환경에서 SSL VPN 설정하고 접속하는 방법&quot; caption=&quot;&quot; %}

## 참고 URL
1. Ncloud SSL VPN 개요
	- &lt;a href=&quot;https://guide.ncloud-docs.com/docs/sslvpn-overview&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://guide.ncloud-docs.com/docs/sslvpn-overview&lt;/a&gt;

2. Ncloud SSL VPN 사용 가이드 - VPC
	- &lt;a href=&quot;https://guide.ncloud-docs.com/docs/sslvpn-start-vpc&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://guide.ncloud-docs.com/docs/sslvpn-start-vpc&lt;/a&gt;
</description>
            <pubDate>Wed, 26 Jul 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/security/ncloud_security_ssl_vpn_vpc_guide.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/security/ncloud_security_ssl_vpn_vpc_guide.html</guid>
            
            <category>vpc</category>
            
            <category>ssl</category>
            
            <category>vpn</category>
            
            
        </item>
        
        <item>
            <title>Rocky Linux에서 Apache SSL 인증서 설정하는 방법</title>
            <description>## 개요
Ncloud (네이버 클라우드) Rocky Linux (록키 리눅스) 서버에 Apache 웹서버를 설치하고, HTTPS 접속을 위한 SSL 인증서 설정하고, HTTP로 접속 시에 HTTPS로 리다이렉트하는 방법까지 정리해보겠습니다. 

## 테스트 환경
테스트에 사용할 서버 환경은 다음과 같습니다.

{% include callout_v2.html type=&quot;secondary&quot; level=&quot;2&quot; content=&quot;
&amp;#8259; OS: Rocky Linux 8.6 &lt;br /&gt;
&amp;#8259; 웹서버: Apache 2.4 &lt;br /&gt; 
&amp;#8259; 테스트 사이트:  rocky-https-test.com
&quot; %}

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-00.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

## 패키지 업데이트
우선 패키지 관련한 보안-버그 수정 사항만 최소한으로 업데이트를 해보겠습니다.

``` bash
~# dnf -y upgrade-minimal
```
{% include callout-v2.html type=&quot;info&quot; level=&quot;2&quot; content=&quot;
[**dnf upgrade-minimal**]과 [**dnf update-minimal**]의 차이점에 대해 [**man dnf**] 명령어로 매뉴얼을 살펴보면 Rocky Linux에서 패키지 업데이트를 위한 기본 명령어는 [**dnf upgrade-minimal**]이며, [**dnf update-minimal**]는 더 이상 사용되지 않는 별칭이라고 합니다.
&quot; %}

``` bash
~# man dnf
#--- 중략 ---#
Upgrade-Minimal Command
       Command: upgrade-minimal
       Aliases: up-min
       Deprecated aliases: update-minimal
```

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-01.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}


## Apache 웹서버 설치

- **Apache 버전 확인**  
[**Rocky Linux 8.6**]에서 기본으로 지원하는 Apache 버전을 확인해보면 [**Apache 2.4**]인 것을 확인할 수 있습니다.

``` bash
~# dnf module list httpd
```

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-02.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

- **Apache 2.4 설치**  

``` bash
~# dnf -y install httpd
```

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-03.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

- **Apache 실행, 상태 확인**  
설치를 마쳤으면 Apache를 실행하고 상태를 확인합니다.

``` bash
~# systemctl start httpd
~# systemctl status httpd
```

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-04.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

## 테스트용 웹사이트 생성
테스트에 필요한 웹사이트 홈 디렉토리와 웹페이지를 생성합니다.

``` bash
~# mkdir -p  /ncloud/data/www/rocky-https-test.com/
~# vim /ncloud/data/www/rocky-https-test.com/index.html
```
``` html
&lt;!doctype html&gt;
&lt;html lang=&quot;kr&quot;&gt;
 &lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;title&gt;Rocky Linux HTTPS Test Site&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
    &lt;h1&gt;Rocky Linux HTTPS Test Site&lt;/h1&gt;
 &lt;/body&gt;
&lt;/html&gt;
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-05.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

## Apache 환경 설정 파일 생성
rocky-https-test.com 웹사이트에 대한 Apache 환경 설정 파일을 생성하고, HTTP 접속에 필요한 80 포트용 설정을 추가합니다.

``` bash
~# vim /etc/httpd/conf.d/rocky-https-test.com.conf
```

``` apache
&lt;VirtualHost *:80&gt;
    ServerName rocky-https-test.com
    DocumentRoot /ncloud/data/www/rocky-https-test.com
    DirectoryIndex index.htm index.html

    CustomLog &quot;/var/log/httpd/rocky-https-test.com-access_log&quot; combined
    ErrorLog  &quot;/var/log/httpd/rocky-https-test.com-error_log&quot;

    &lt;Directory /ncloud/data/www/rocky-https-test.com&gt;
        Options None
        AllowOverride None
        Require all granted
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-06.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

- 설정 파일을 저장한 후에 Apache 데몬을 재시작합니다.

``` bash
~# systemctl restart httpd
```

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-07.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

## hosts 파일 수정
지금과 같이 테스트용으로 임의 설정한 도메인(**rocky-https-test.com**)으로 접속하게 될 경우에는 hosts 파일을 수정해야 합니다.  
`실제 도메인을 사용할 경우에는 아래 과정이 필요 없기에` [다음 단계로 바로 이동&lt;i class=&quot;fa-solid fa-turn-down&quot;&gt;&lt;/i&gt;](#acg-setting)하시면 됩니다. 

윈도우 10에서 hosts 파일은 C:\Windows\System32\drivers\etc 에 존재하는데 직접 수정할 수가 없으므로 다음과 같은 단계를 거쳐야 합니다.

1. C:\Windows\System32\drivers\etc\hosts 파일을 임의의 작업 폴더 (예: D:\Work)로 복사합니다.
2. 복사한 hosts 파일을 수정해서 123.456.789.123 rocky-https-test.com 처럼 접속할 IP 주소와 도메인을 추가합니다.
3. 수정한 파일을 C:\Windows\System32\drivers\etc 위치로 덮어쓰기 합니다.
4. 덮어쓰기 할 때 관리자 권한이 필요하다는 안내 메시지가 나타나면 [계속] 버튼을 클릭합니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-08.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-ssl-setting-guide-centos-05.png&quot; width=&quot;710&quot; alt=&quot;Ncloud CentOS 서버에 NginX SSL 인증서를 설정하는 방법&quot; caption=&quot;&quot; %}

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-ssl-setting-guide-centos-06.png&quot; width=&quot;710&quot; alt=&quot;Ncloud CentOS 서버에 NginX SSL 인증서를 설정하는 방법&quot; caption=&quot;&quot; %}

## ACG (방화벽) 설정 {#acg-setting}
테스트로 생성했던 서버를 선택하고 [ACG 수정] 버튼을 클릭해서 적용된 ACG를 확인합니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-23.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

- ACG 수정 화면에서 현재 적용된 ACG 이름을 확인할 수 있습니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-24.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

- [Server] - [ACG]에서 위에서 확인한 ACG를 선택하고 [ACG 설정]을 클릭합니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-25.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

### 내부 테스트용 ACG 설정
내부 테스트용 설정은 ACG 규칙 설정 화면에서 [**Inbound**] 탭에서 [**myIp**] 버튼을 클릭해서 현재 접속한 PC나 회사 IP를 입력하고, HTTP용 80포트와 HTTPS용 443포트를 추가합니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-09.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

### 라이브 서비스용 ACG 설정
라이브 서비스용 설정은 접근 소스에는 [**0.0.0.0/0**]을 입력하고, 마찬가지로 HTTP용 80포트와 HTTPS용 443포트를 추가합니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-10.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

## HTTP 접속 테스트
ACG 설정을 마쳤으면 웹브라우저에 테스트용 사이트의 주소 [**http://rocky-https-test.com**]으로 접속을 해보면 문제 없이 잘 접속되는 것을 확인할 수 있습니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-11.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

## SSL 인증서 설정

### mod_ssl 설치

``` bash
~# dnf -y install mod_ssl
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-12.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

- 우선 인증서 저장용 디렉토리를 생성합니다.

``` bash
~# mkdir -p /root/ssl/
```

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-13.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

### SSL 테스트 인증서 생성
여기서는 테스트용 인증서를 생성해서 사용하게 되는데, 정식 서비스의 경우 SSL 인증서 발급 기관에서 정식 인증서를 발급 받아 사용하게 됩니다.  
정식 인증서를 사용하는 경우에는 테스트 인증서 생성 단계는 건너띄고 다음 단계로 이동하시면 되겠습니다.

``` bash
~# openssl req -newkey rsa:2048 \
-nodes -keyout /root/ssl/rocky-https-test.com.key \
-x509 -days 365 -out /root/ssl/rocky-https-test.com.crt
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-14.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

- 인증서 파일이 제대로 생성되었는지 확인합니다.

``` bash
~# ls -al /root/ssl/
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-15.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

### HTTPS용 환경 설정 추가
앞에서 생성했던 환경 설정 파일 [**rocky-https-test.com.conf**]에 HTTPS용 설정을 추가합니다.

``` bash
~# vim /etc/httpd/conf.d/rocky-https-test.com.conf
```
``` apache
&lt;VirtualHost *:443&gt;
    ServerName rocky-https-test.com
    DocumentRoot /ncloud/data/www/rocky-https-test.com
    DirectoryIndex index.htm index.html

    CustomLog &quot;/var/log/httpd/rocky-https-test.com-ssl-access_log&quot; combined
    ErrorLog  &quot;/var/log/httpd/rocky-https-test.com-ssl-error_log&quot;

    SSLEngine on
    SSLProtocol -all +TLSv1.2 +TLSv1.3 
    SSLHonorCipherOrder on
    SSLCipherSuite PROFILE=SYSTEM

    SSLCertificateFile /root/ssl/rocky-https-test.com.crt
    SSLCertificateKeyFile /root/ssl/rocky-https-test.com.key

    &lt;Directory /ncloud/data/www/rocky-https-test.com&gt;
        Options None
        AllowOverride None
        Require all granted
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-16.png&quot; width=&quot;840&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

{% include callout-v2.html type=&quot;warning&quot; level=&quot;2&quot; content=&quot;
- **SSLProtocol**: SSL Protocol에 대한 설정은 [TLS v1.2], [TLS v1.3] 만 허용하고, 나머지 Protocol은 모두 거부하도록 설정했습니다. &lt;br /&gt;
- **정식 인증서**에서는 [SSLCertificateFile], [SSLCertificateKeyFile] 외에도 [SSLCertificateChainFile], [SSLCACertificateFile] 등의 키 설정이 필요하게 되는데, 자세한 내용은 인증서 발급 대행사에서 인증서를 발급 받을 때 포함되어 있는 가이드 문서를 참고하시면 됩니다.
&quot; %}
&lt;br /&gt;
- 설정 파일을 저장한 후에 Apache 데몬을 재시작합니다.

``` bash
~# systemctl restart httpd
```

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-07.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

## HTTPS 접속 테스트
설정을 마쳤으면 웹브라우저에서 HTTPS로 [https://rocky-https-test.com]에 접속을 해보면 문제 없이 잘 접속되는 것을 확인할 수 있습니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-17.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

### 인증서 확인
HTTPS로 테스트 사이트에 접속 후에 인증서를 확인해보면 위에서 테스트로 생성했던 정보가 제대로 설정되어 있는 것을 확인할 수 있습니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-21.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-22.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-top&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

## HTTP 접속 시 HTTPS로 리다이렉트
이제 HTTPS 설정까지 마쳤으니 HTTP로 접속하는 경우에 HTTPS로 리다이렉트 시키는 설정을 적용해보겠습니다.  

### 방법 - 1
첫번째 방법은 [**Redirect**] 옵션을 이용하는 방법입니다.  
앞에서 설정한 HTTP용 환경 설정에서 [**ServerName**]을 제외한 다른 항목들은 모두 삭제하거나 주석처리한 후에 리다이렉트 설정을 추가합니다.

``` bash
~# vim /etc/httpd/conf.d/rocky-https-test.com.conf
```
``` apache
&lt;VirtualHost *:80&gt;
    ServerName rocky-https-test.com

    Redirect permanent / https://rocky-https-test.com/
    # 또는
    # Redirect 301 / https://rocky-https-test.com/
&lt;/VirtualHost&gt;    
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-18.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

### 리다이렉트 여부 확인
웹브라우저에서 [**F12**] 키로 개발자 모드로 변경한 후에 [**http://rocky-https-test.com/**]로 접속을 해보면 아래 스샷처럼 HTTP 301 상태코드를 반환하면서 [**https://rocky-https-test.com/**]로 리다이렉트된 것을 확인할 수 있습니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-19.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

### 방법 - 2
두번째 방법은 [**RewirteRule**] 옵션을 이용하는 방법입니다.  
첫번째 방법이 더 간편하기는 하지만, 리다이렉트 시킬 때 HTTP 상태코드 뿐만 아니라 HTTP Header 값 등 다양한 설정이 필요한 경우에는 [**RewirteRule**]을 이용하는 두번째 방법을 사용해야 합니다.  

``` apache
&lt;VirtualHost *:80&gt;
    ServerName rocky-https-test.com

    RewriteEngine On
    RewriteCond %{HTTPS} !on
    RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L]
&lt;/VirtualHost&gt; 
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-20.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}



## 참고 URL
1.  Rocky Linux Apache Multiple Site 설정 가이드
	- &lt;a href=&quot;https://docs.rockylinux.org/guides/web/apache-sites-enabled/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.rockylinux.org/guides/web/apache-sites-enabled/&lt;/a&gt;

2.  Rocky Linux Apache with &apos;mod_ssl&apos; 가이드
	- &lt;a href=&quot;https://docs.rockylinux.org/guides/web/mod_SSL_apache/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.rockylinux.org/guides/web/mod_SSL_apache/&lt;/a&gt;</description>
            <pubDate>Thu, 13 Jul 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/compute/ncloud-compute-lamp-apache-ssl-setting-rocky-linux-guide.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/compute/ncloud-compute-lamp-apache-ssl-setting-rocky-linux-guide.html</guid>
            
            <category>rocky_linux</category>
            
            <category>lamp</category>
            
            <category>apache</category>
            
            <category>install</category>
            
            
        </item>
        
        <item>
            <title>http 접속 시에 https로 강제 리다이렉트 시키는 방법 - Apache/CentOS</title>
            <description>## 개요
웹사이트 SSL 인증서를 설치하고 https 접속을 유도할 때 http로 접속하면 https로 강제로 리다이렉트 시키는 방법을 사용하는 경우가 많습니다. 웹페이지 소스에서 http 접속 여부를 판단해서 redirect 시키는 방법 등 여러가지 있을 수 있는데 여기서는 Apache 설정으로 쉽게 할 수 있는 방법을 소개합니다.  

SSL 인증서가 설치되어 있다는 가정하에 우선 Linux CentOS에서 설정하는 방법을 확인해보겠습니다.

## 테스트 환경
테스트에 사용한 서버 환경은 다음과 같습니다.

{% include callout_v2.html type=&quot;secondary&quot; level=&quot;2&quot; content=&quot;
&amp;#8259; OS: CentOS 7.8 &lt;br /&gt;
&amp;#8259; 웹서버: Apache 2.4 
&quot; %}

## Apache conf 파일 수정
**/etc/httpd/conf/httpd.conf** 또는 별도로 설정한 **/etc/httpd/conf.d/사이트도메인.conf** 등의 Vritual host에 다음 코드를 추가하고 Apache를 재시작하면 됩니다.

## 방법1 : Redirect 옵션
첫번째 방법은 [**Redirect**] 옵션을 이용하는 방법입니다.  
HTTP 환경 설정에서 [**ServerName**]을 제외한 다른 항목들은 모두 삭제하거나 주석처리한 후에 리다이렉트 설정을 추가합니다.

``` apache
&lt;VirtualHost *:80&gt;
    ServerName 사이트_도메인

    Redirect permanent / https://사이트_도메인/    
&lt;/VirtualHost&gt; 
```

- `301` 리다이렉트: **Redirect** `permanent` / https://사이트_도메인/
- `302` 리다이렉트: **Redirect** / https://사이트_도메인/
- `301` 리다이렉트: **Redirect** `301` / https://사이트_도메인/
- `302` 리다이렉트: **Redirect** `302` / https://사이트_도메인/
- `307` 리다이렉트: **Redirect** `307` / https://사이트_도메인/
- `308` 리다이렉트: **Redirect** `308` / https://사이트_도메인/

## 방법2 : RewirteRule 옵션
두번째 방법은 [**RewirteRule**] 옵션을 이용하는 방법입니다.  
첫번째 방법이 더 간편하기는 하지만, 리다이렉트 시킬 때 HTTP 상태코드 뿐만 아니라 HTTP Header 값 등 다양한 설정이 필요한 경우에는 [**RewirteRule**]을 이용하는 두번째 방법을 사용해야 합니다.  

``` apache
&lt;VirtualHost *:80&gt;
    ServerName 사이트_도메인

    RewriteEngine On
    RewriteCond %{HTTPS} !on
    RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L]
&lt;/VirtualHost&gt; 
```

위 설정 중에서 [R=301,L] 이 부분에 원하는 상태코드를 입력하면 됩니다. 
- `301` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`301`,L]
- `302` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`302`,L]
- `307` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`307`,L]
- `308` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`308`,L]

## Apache 재시작
``` bash
~# systemctl restart httpd
```
이렇게 재시작하고 http로 접속을 해보면 https로 전환되는 것을 확인할 수 있습니다.


## SSL 모듈 설치
혹시 Apache에 mod_ssl 가 설치되어 있지 않다면 설치하셔야 합니다.

``` bash
~# yum -y install mod_ssl
```

``` bash
========================================================================
 Package   Arch       Version                 Repository   Size
========================================================================
Installing:
 mod_ssl    x86_64   1:2.4.6-97.el7.centos   updates    114 k

Transaction Summary
========================================================================
Install  1 Package

Total download size: 114 k
Installed size: 224 k

Downloading packages:
mod_ssl-2.4.6-97.el7.centos.x86_64.rpm                    | 114 kB  00:00:00
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : 1:mod_ssl-2.4.6-97.el7.centos.x86_64        1/1
  Verifying  : 1:mod_ssl-2.4.6-97.el7.centos.x86_64        1/1

Installed:
  mod_ssl.x86_64 1:2.4.6-97.el7.centos

Complete!
```

## 참고 URL
1.  http 접속 시에 https로 강제 리다이렉트 시키는 방법 - Apache/Rocky Linux
	- &lt;a href=&quot;/compute/ncloud-compute-server-http-to-https-rocky-linux.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/compute/ncloud-compute-server-http-to-https-rocky-linux.html&lt;/a&gt;

2.  http 접속 시에 https로 강제 리다이렉트 시키는 방법 - Apache/Ubuntu
	- &lt;a href=&quot;/compute/ncloud_compute_server_http_to_https_ubuntu.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/compute/ncloud_compute_server_http_to_https_ubuntu.html&lt;/a&gt;</description>
            <pubDate>Wed, 12 Jul 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/compute/ncloud_compute_server_http_to_https_centos.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/compute/ncloud_compute_server_http_to_https_centos.html</guid>
            
            <category>apache</category>
            
            <category>centos</category>
            
            
        </item>
        
        <item>
            <title>http 접속 시에 https로 강제 리다이렉트 시키는 방법 - Apache/Ubuntu</title>
            <description>## 개요
웹사이트 SSL 인증서를 설치하고 https 접속을 유도할 때 http로 접속하면 https로 강제로 리다이렉트 시키는 방법을 사용하는 경우가 많습니다.  
웹페이지 소스에서 http 접속 여부를 판단해서 redirect 시키는 방법 등 여러가지 있을 수 있는데 여기서는 Apache 설정으로 쉽게 할 수 있는 방법을 소개합니다.  

SSL 인증서가 설치되어 있다는 가정하에 우선 Linux Ubuntu에서 설정하는 방법을 확인해보겠습니다.

## 테스트 환경
테스트에 사용한 서버 환경은 다음과 같습니다.

{% include callout_v2.html type=&quot;secondary&quot; level=&quot;2&quot; content=&quot;
&amp;#8259; OS: Ubuntu 20.04 &lt;br /&gt;
&amp;#8259; 웹서버: Apache 2.4 
&quot; %}


## SSL 엔진 모듈 활성화
먼저, SSL 엔진 모듈을 활성화 해야 HTTPS 접속을 할 수 있습니다.

``` bash
~# a2enmod ssl
~# systemctl restart apache2
```

## Apache conf 파일 수정
**/etc/apache2/sites-enabled/000-default.conf** 파일의 Vritual host에 다음 코드를 추가하고 Apache를 재시작하면 됩니다.

## 방법1 : Redirect 옵션
첫번째 방법은 [**Redirect**] 옵션을 이용하는 방법입니다.  
HTTP 환경 설정에서 [**ServerName**]을 제외한 다른 항목들은 모두 삭제하거나 주석처리한 후에 리다이렉트 설정을 추가합니다.

``` apache
&lt;VirtualHost *:80&gt;
    ServerName 사이트_도메인

    Redirect permanent / https://사이트_도메인/    
&lt;/VirtualHost&gt; 
```

- `301` 리다이렉트: **Redirect** `permanent` / https://사이트_도메인/
- `302` 리다이렉트: **Redirect** / https://사이트_도메인/
- `301` 리다이렉트: **Redirect** `301` / https://사이트_도메인/
- `302` 리다이렉트: **Redirect** `302` / https://사이트_도메인/
- `307` 리다이렉트: **Redirect** `307` / https://사이트_도메인/
- `308` 리다이렉트: **Redirect** `308` / https://사이트_도메인/

## 방법2 : RewirteRule 옵션
두번째 방법은 [**RewirteRule**] 옵션을 이용하는 방법입니다.  
첫번째 방법이 더 간편하기는 하지만, 리다이렉트 시킬 때 HTTP 상태코드 뿐만 아니라 HTTP Header 값 등 다양한 설정이 필요한 경우에는 [**RewirteRule**]을 이용하는 두번째 방법을 사용해야 합니다.  

### Rewrite 모듈 설치
우선, RewirteRule 옵션을 사용하려면 Rewrite 모듈을 활성화 해야합니다.

``` bash
~# a2enmod rewrite
~# systemctl restart apache2
```

``` apache
&lt;VirtualHost *:80&gt;
	ServerName 사이트_도메인

	RewriteEngine On
	RewriteCond %{HTTPS} !on
	RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L]
&lt;/VirtualHost&gt;
```

위 설정 중에서 [R=301,L] 이 부분에 원하는 상태코드를 입력하면 됩니다. 
- `301` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`301`,L]
- `302` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`302`,L]
- `307` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`307`,L]
- `308` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`308`,L]


## Apache 재시작
``` bash
~# systemctl restart apache2
```
이렇게 재시작하고 http로 접속을 해보면 https로 전환되는 것을 확인할 수 있습니다.

## 참고 URL
1.  http 접속 시에 https로 강제 리다이렉트 시키는 방법 - Apache/Rocky Linux
	- &lt;a href=&quot;/compute/ncloud-compute-server-http-to-https-rocky-linux.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/compute/ncloud-compute-server-http-to-https-rocky-linux.html&lt;/a&gt;

2.  http 접속 시에 https로 강제 리다이렉트 시키는 방법 - Apache/CentOS
	- &lt;a href=&quot;/compute/ncloud_compute_server_http_to_https_centos.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/compute/ncloud_compute_server_http_to_https_centos.html&lt;/a&gt;</description>
            <pubDate>Wed, 12 Jul 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/compute/ncloud_compute_server_http_to_https_ubuntu.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/compute/ncloud_compute_server_http_to_https_ubuntu.html</guid>
            
            <category>apache</category>
            
            <category>ubuntu</category>
            
            
        </item>
        
        <item>
            <title>http 접속 시에 https로 강제 리다이렉트 시키는 방법 - Apache/Rocky Linux</title>
            <description>## 개요
Ncloud (네이버 클라우드) Rocky Linux (록키 리눅스) 서버 Apache 웹서버에서 http 접속 시에 https로 강제 리다이렉트 시키는 방법은 크게 2가지가 있는데 각각에 대해 정리해보겠습니다.

## 테스트 환경
테스트에 사용한 서버 환경은 다음과 같습니다.

{% include callout_v2.html type=&quot;secondary&quot; level=&quot;2&quot; content=&quot;
&amp;#8259; OS: Rocky Linux 8.6 &lt;br /&gt;
&amp;#8259; 웹서버: Apache 2.4 &lt;br /&gt; 
&amp;#8259; 테스트 사이트:  rocky-https-test.com
&quot; %}

## 방법1 : Redirect 옵션
첫번째 방법은 [**Redirect**] 옵션을 이용하는 방법입니다.  
HTTP 환경 설정에서 [**ServerName**]을 제외한 다른 항목들은 모두 삭제하거나 주석처리한 후에 리다이렉트 설정을 추가합니다.

``` apache
&lt;VirtualHost *:80&gt;
    ServerName 사이트_도메인

    Redirect permanent / https://사이트_도메인/    
&lt;/VirtualHost&gt;    
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-18.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

- `301` 리다이렉트: **Redirect** `permanent` / https://사이트_도메인/
- `302` 리다이렉트: **Redirect** / https://사이트_도메인/
- `301` 리다이렉트: **Redirect** `301` / https://사이트_도메인/
- `302` 리다이렉트: **Redirect** `302` / https://사이트_도메인/
- `307` 리다이렉트: **Redirect** `307` / https://사이트_도메인/
- `308` 리다이렉트: **Redirect** `308` / https://사이트_도메인/

## 방법2 : RewirteRule 옵션
두번째 방법은 [**RewirteRule**] 옵션을 이용하는 방법입니다.  
첫번째 방법이 더 간편하기는 하지만, 리다이렉트 시킬 때 HTTP 상태코드 뿐만 아니라 HTTP Header 값 등 다양한 설정이 필요한 경우에는 [**RewirteRule**]을 이용하는 두번째 방법을 사용해야 합니다.  

``` apache
&lt;VirtualHost *:80&gt;
    ServerName 사이트_도메인

    RewriteEngine On
    RewriteCond %{HTTPS} !on
    RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L]
&lt;/VirtualHost&gt; 
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-20.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}

위 설정 중에서 [R=301,L] 이 부분에 원하는 상태코드를 입력하면 됩니다. 
- `301` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`301`,L]
- `302` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`302`,L]
- `307` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`307`,L]
- `308` 리다이렉트: RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=`308`,L]


- 설정 파일을 저장한 후에 Apache 데몬을 재시작합니다.

``` bash
~# systemctl restart httpd
```

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-07.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}


## 리다이렉트 여부 확인
웹브라우저에서 [**F12**] 키로 개발자 모드로 변경한 후에 [**http**]로 접속을 해보면 아래 스샷처럼 HTTP 301 상태코드를 반환하면서 [**https**]로 리다이렉트된 것을 확인할 수 있습니다.

{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-19.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}


## SSL 모듈 설치
리다이렉트 설정과 관계없이 SSL 인증서를 설정하고 HTTPS 접속을 하려면 [**mod_ssl**]가 설치되어 있어야 하는데, 혹시나 설치되어 있지 않다면 설치하셔야 합니다.

``` bash
~# dnf -y install mod_ssl
```
{% include image.html file=&quot;compute/lamp/ncloud-server-apache-ssl-setting-guide-rocky-linux-12.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버 Apache에 HTTPS 접속을 위한 SSL 인증서 설정하는 방법&quot; caption=&quot;&quot; %}


## 참고 URL
1.  Rocky Linux에서 Apache SSL 인증서 설정하는 방법
	- &lt;a href=&quot;/compute/ncloud-compute-lamp-apache-ssl-setting-rocky-linux-guide.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/compute/ncloud-compute-lamp-apache-ssl-setting-rocky-linux-guide.html&lt;/a&gt;

2.  Rocky Linux Apache with &apos;mod_ssl&apos; 가이드
	- &lt;a href=&quot;https://docs.rockylinux.org/guides/web/mod_SSL_apache/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.rockylinux.org/guides/web/mod_SSL_apache/&lt;/a&gt;</description>
            <pubDate>Tue, 11 Jul 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/compute/ncloud-compute-server-http-to-https-rocky-linux.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/compute/ncloud-compute-server-http-to-https-rocky-linux.html</guid>
            
            <category>rocky_linux</category>
            
            <category>lamp</category>
            
            <category>apache</category>
            
            <category>install</category>
            
            
        </item>
        
        <item>
            <title>Jenkins 서버 설치 가이드 | Rocky Linux</title>
            <description>## 개요
Ncloud (네이버 클라우드)의 Classic 환경에서는 Jekins 서버 이미지를 제공하고 있지만, VPC 환경에서는 제공하지 않기에 VPC 환경 록키 리눅스(Rocky Linux) 서버에 Jekins 서버를 설치하는 과정을 정리해보겠습니다.

## Jenkins란
Jenkins는 지속적 통합(Continuous Integration, CI)과 지속적 배포(Continuous Delivery, CD)를 위한 대표적인 도구로 빌드, 테스트, 배포 프로세스를 자동화하여 소프트웨어 품질 향상과 개발 생산성 향상에 도움을 주는 도구입니다.

## Jenkins 특징

- 지속적 통합을 사용하여 빌드, 테스트, 배포 과정을 자동화하여 개발 생산성을 향상할 수 있습니다.
- 자동화 테스트를 통하여 소프트웨어 품질을 향상할 수 있습니다.
- 지속적인 통합을 통해 안정적인 릴리즈를 빠르게 배포할 수 있습니다.


## 설치 과정 

### 패키지 저장소 추가
먼저 Jenkins의 패키지 저장소를 추가합니다.

```bash
~# wget -O /etc/yum.repos.d/jenkins.repo \
    https://pkg.jenkins.io/redhat-stable/jenkins.repo
```

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-01.png&quot; width=&quot;840&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

### GPG 키 추카
그런 다음 Jenkins GPG 키를 다음과 같이 추가 합니다.

```bash
~# rpm --import \
    https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key
```

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-02.png&quot; width=&quot;840&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

## 패키지 업데이트
그리고, 패키지 관련한 보안-버그 수정 사항만 최소한으로 업데이트를 진행합니다.

``` bash
~# dnf -y upgrade-minimal
```

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-03.png&quot; width=&quot;840&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

### JAVA 설치
Jenkins를 구동하기 위해서 필요한 JAVA 11 버전을 설치합니다.

```bash
~# dnf -y install java-11-openjdk
```
{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-04.png&quot; width=&quot;840&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

### JAVA 버전 선택 {#java-version-select}
현재 시스템에 설치된 JAVA는 기본 설치 버전인 [**java-1.8.0**]과 좀 전에 설치한 [**java-11**] 이렇게 2가지인데, Jenkins는 [**java-11**] 버전을 사용하므로 다음 명령어로 [**java-11**] 버전이 기본으로 적용되도록 설정을 변경하겠습니다.  
명령어 입력 후 나타난 선택화면에서 [**java-11**] 버전에 해당하는 2번을 입력합니다. 그리고, 변경이 제대로 되었는지 java 버전을 확인합니다.

``` bash
~# update-alternatives --config java
~# java -version
```

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-05.png&quot; width=&quot;840&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

### Jenkins 설치
모든 준비가 끝났으면 Jenkins를 설치합니다.

```bash
~# dnf -y install jenkins
```

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-06.png&quot; width=&quot;840&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

### Jenkins 서비스 시작
Jekins 서비스를 시작하고 정상 작동을하고 있는지 다음과 같이 확인합니다.

``` bash
~# systemctl daemon-reload
~# systemctl enable jenkins
~# systemctl start jenkins
~# systemctl status jenkins
```

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-07.png&quot; width=&quot;840&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-08.png&quot; width=&quot;840&quot; sub-class=&quot;docimage-no-top&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}


## 방화벽 ACG 설정
Jekins 서버가 사용하는 기본 포트는 8080 입니다. Ncloud 방화벽 ACG에서 8080 포트를 허용해줍니다.

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-09.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}


## 초기 설정

### Port 변경
{% include callout_v2.html type=&quot;warning&quot; level=&quot;2&quot; content=&quot;Jenkins의 기본 접속 Port는 8080인데 /etc/sysconfig/jenkins 의 JENKINS_PORT= 항목에서 변경 할 수 있습니다.&quot; %} 

``` bash
~# vi /etc/sysconfig/jenkins
```

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-10.png&quot; width=&quot;840&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

### 초기 패스워드 확인

설치가 완료 되면 http://{서버 IP주소}:8080 으로 접속하면 아래의 스크린샷처럼 초기 어드민 패스워드를 입력하는 화면이 나타납니다.

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-11.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

초기 어드민 패스워드는 **/var/lib/jenkins/secrets/initialAdminPassword** 파일에 기록되어 있습니다.  
cat 명령어로 초기 패스워드를 확인합니다.

```bash
~# cat /var/lib/jenkins/secrets/initialAdminPassword
```

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-12.png&quot; width=&quot;840&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

## 플러그인 설치
플러그인 설치는 추천 플러그인을 설치하는 옵션과 직접 선택해서 설치하는 옵션이 있습니다. 일단 여기서는 추천 플러그인을 선택하겠습니다.

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-13.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

추천 플러그인을 선택하면 아래와 같이 설치과정이 나타납니다.

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-14.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

직접 플러그인을 선택할 경우 아래와 같이 여러 플러그인 중에서 설치하고 싶은 플러그인을 선택할 수 있습니다.

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-15.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}


## 어드민 계정 정보 입력
플러그인 설치를 마치면 아래와 같이 어드민 계정 정보를 입력하게 됩니다.

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-16.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}


## 설치 완료
필요한 정보를 모두 입력하고 나면 마지막으로 Jekins URL을 확정하고 저장합니다.

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-17.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

설치가 모두 끝났습니다.

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-18.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

이제 Jekins에 접속하면 아래와 같은 화면을 확인할 수 있습니다.

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-19.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}


## 오류 상황
위 순서대로 설치를 진행했다면 문제 없이 설치가 되겠지만, 혹시나 설치 중에 중요한 과정을 빠뜨렸을 경우 아래아 같이 [**Jenkins**]를 시작하려고 할 때 오류가 발생하게 됩니다.

```  bash
~# systemctl start jenkins

Job for jenkins.service failed because the control process exited with error code.
See &quot;systemctl status jenkins.service&quot; and &quot;journalctl -xe&quot; for details.
```
{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-20.png&quot; width=&quot;840&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

### 오류 원인 분석 
위 오류 메시지에서 2가지 방법으로 상세한 오류 내용을 확인해보겠습니다.

- 우선 첫번째 명령 [**systemctl status jenkins.service**]으로 확인을 해보았으나 별다른 내용은 나오지 않습니다.

``` bash
~# systemctl status jenkins.service

● jenkins.service - Jenkins Continuous Integration Server
   Loaded: loaded (/usr/lib/systemd/system/jenkins.service; enabled; vendor preset: disabled)
   Active: failed (Result: exit-code) since Fri 2023-06-30 17:08:01 KST; 1min 25s ago
  Process: 6494 ExecStart=/usr/bin/jenkins (code=exited, status=1/FAILURE)
 Main PID: 6494 (code=exited, status=1/FAILURE)

Jun 30 17:08:01 jenkins-test systemd[1]: Failed to start Jenkins Continuous Integration Server.
Jun 30 17:08:01 jenkins-test systemd[1]: jenkins.service: Service RestartSec=100ms expired, scheduling restart
Jun 30 17:08:01 jenkins-test systemd[1]: jenkins.service: Scheduled restart job, restart counter is at 5.
Jun 30 17:08:01 jenkins-test systemd[1]: Stopped Jenkins Continuous Integration Server.
Jun 30 17:08:01 jenkins-test systemd[1]: jenkins.service: Start request repeated too quickly.
Jun 30 17:08:01 jenkins-test systemd[1]: jenkins.service: Failed with result &apos;exit-code&apos;.
Jun 30 17:08:01 jenkins-test systemd[1]: Failed to start Jenkins Continuous Integration Server.
Jun 30 17:08:03 jenkins-test systemd[1]: jenkins.service: Start request repeated too quickly.
Jun 30 17:08:03 jenkins-test systemd[1]: jenkins.service: Failed with result &apos;exit-code&apos;.
Jun 30 17:08:03 jenkins-test systemd[1]: Failed to start Jenkins Continuous Integration Server.
```
{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-21.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

- 다음으로 [**journalctl -xe**] 명령을 입력해보니 상당히 긴 로그가 나오는데, 차근차근 살펴보다 보니 원인을 찾을 수 있었는데, 그 부분만 발췌해보면 아래와 같습니다.

``` bash
~# journalctl -xe

#------------- 중간 생략 --------------#
-- Unit jenkins.service has begun starting up.
Jun 30 17:37:41 jenkins-test jenkins[7588]: jenkins: invalid Java version: openjdk version &quot;1.8.0_352&quot;
Jun 30 17:37:41 jenkins-test jenkins[7588]: OpenJDK Runtime Environment (build 1.8.0_352-b08)
Jun 30 17:37:41 jenkins-test jenkins[7588]: OpenJDK 64-Bit Server VM (build 25.352-b08, mixed mode)
Jun 30 17:37:41 jenkins-test systemd[1]: jenkins.service: Main process exited, code=exited, status=1/FAILURE
Jun 30 17:37:41 jenkins-test systemd[1]: jenkins.service: Failed with result &apos;exit-code&apos;.
-- Subject: Unit failed
-- Defined-By: systemd
-- Support: https://lists.freedesktop.org/mailman/listinfo/systemd-devel
--
-- The unit jenkins.service has entered the &apos;failed&apos; state with result &apos;exit-code&apos;.
Jun 30 17:37:41 jenkins-test systemd[1]: Failed to start Jenkins Continuous Integration Server.
-- Subject: Unit jenkins.service has failed
-- Defined-By: systemd
-- Support: https://lists.freedesktop.org/mailman/listinfo/systemd-devel
--
-- Unit jenkins.service has failed.
--
-- The result is failed.
#------------- 중간 생략 --------------#
```

{% include callout-v2.html type=&quot;warning&quot; level=&quot;3&quot; content=&quot;
오류 로그 중에서 핵심이 되는 부분은 바로 이 문장입니다. &lt;br /&gt;
**`jenkins: invalid Java version: openjdk version &apos;1.8.0_352&apos;`**
&quot; %}

{% include image.html file=&quot;dev-tools/ncloud-dev-tools-jenkins-install-guide-rocky-linux-22.png&quot; width=&quot;845&quot; alt=&quot;Ncloud VPC 환경에서 Rocky Linux에 Jenkins 서버를 설치하는 방법&quot; caption=&quot;&quot; %}

### 오류 해결
즉, **오류 원인은 JAVA 버전**이었습니다. 현재의 Jenkins는 [java-11] 버전을 사용하는데, `[java-11]을 설치하지 않았거나` 현재 시스템에 JAVA가 [java-11] 뿐만 아니라 [java-1.8.0] 버전도 함께 설치되어 있는데, `[java-1.8.0] 버전이 기본 버전으로 설정된 상태여서 생기는 문제`입니다.  

위쪽 설치 단계에서 확인했던 아래 명령으로 JAVA 기본 버전을 [java-11]로 변경해주고 Jenkins를 시작하면 문제가 없습니다. 

- **[JAVA 기본 버전 변경하기 &lt;i class=&quot;fa-solid fa-arrow-up-from-bracket&quot;&gt;&lt;/i&gt;](#java-version-select)**

``` bash
~# update-alternatives --config java
~# java -version
```



## 참고 URL
1. Jeins Redhat Packages
    - &lt;a href=&quot;https://pkg.jenkins.io/redhat-stable/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all&quot;&gt;https://pkg.jenkins.io/redhat-stable/&lt;/a&gt;

2. Jenkins User Documentation
    - &lt;a href=&quot;https://www.jenkins.io/doc/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all&quot;&gt;https://www.jenkins.io/doc/&lt;/a&gt;


</description>
            <pubDate>Mon, 03 Jul 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/dev-tools/ncloud-dev-tools-jenkins-server-install-guide-rocky-linux.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/dev-tools/ncloud-dev-tools-jenkins-server-install-guide-rocky-linux.html</guid>
            
            <category>github</category>
            
            
        </item>
        
        <item>
            <title>Ncloud Rocky Linux 서버 Repository 미러 사이트 오류 문제 해결 방법</title>
            <description>## 개요  
Ncloud (네이버 클라우드)에서 록키 리눅스(Rocky Linux) 8.6 서버를 제공하고 있는데, 패키지를 설치할 때 간혹 패키지 다운로드 사이트 또는 미러 사이트에서 8.6 버전에 대한 패키지 정보를 찾을 수 없다는 메시지가 나타나면서 패키지를 설치할 수 없는 경우가 있습니다.   
그렇다면 왜 이런 문제가 생기는지와 어떻게 하면 해결할 수 있는지를 정리해보겠습니다.

## 오류 상황
테스트로 아파치를 설치해보려고 했는데, 오류 메시지가 나타나면서 설치를 할 수 없었습니다. 또한 리포지토리 미러 사이트도 Ncloud 내부 서버가 아닌 록키 리눅스 공식 미러 사이트로 연결하려고 시도한 것을 확인할 수 있습니다.

``` bash
~# dnf -y install httpd

Rocky Linux 8.6 - Extras                                 5.4 kB/s |  20 kB     00:03
Errors during downloading metadata for repository &apos;extras&apos;:
  - Status code: 404 for https://mirrors.rockylinux.org/mirrorlist?arch=x86_64&amp;repo=extras-8.6 (IP: 151.101.26.132)
  - Status code: 404 for https://mirrors.rockylinux.org/mirrorlist?arch=x86_64&amp;repo=extras-8.6 (IP: 146.75.94.132)
Error: Failed to download metadata for repo &apos;extras&apos;: Cannot prepare internal mirrorlist: Status code: 404 for https://mirrors.rockylinux.org/mirrorlist?arch=x86_64&amp;repo=extras-8.6 (IP: 151.101.26.132)
```
{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-01.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}

## 미러 사이트 확인
오류 메시지에 나온 공식 미리 사이트에 접속해보니 [**AppStream**], [**extras**] 등 모든 8.6 버전에 대한 정보가 사라진 것을 확인할 수 있었습니다.

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-02.png&quot; width=&quot;845&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}

## 오류 상황 요약 정리
현재 확인되는 오류 상황을 정리해보면 다음과 같습니다.

1. 패키지를 검색하는 저장소가 [**AppStream**] 이나 [**BaseOS**]가 아닌 [**Extras**]로 변경되어 있다.
2. 리포지토리 미러 사이트를 Ncloud 내부 서버가 아닌 외부에 있는 록키 리눅스 공식 미러 사이트로 접속시도 하고 있다.
3. 외부에 있는 록키 리눅스 공식 미러 사이트에서는 공식 지원이 종료되는 8.6 버전에 대한 데이터가 이미 삭제되어 있다. 

## 원인 분석
원인 분석을 하기 위해 서버의 리포지토리 설정을 확인해보겠습니다.

### 리포지토리 설정 - 오류 서버
[**/etc/yum.repos.d/**] 디렉토리에 있는 리포지토리 설정 파일을 확인해보면 아래와 같이 다수의 파일이 존재하는 것을 확인할 수 있습니다.

``` bash
~# ls -al /etc/yum.repos.d/
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-06.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}

- 위에서 확인한 설정 파일들 중에서 [**Rocky-Extras.repo**] 파일을 열어서 미러 사이트 주소를 확인해보면, Ncloud 내부 서버가 아닌 아래와 같이 록키 리눅스 공식 사이트로 설정되어 있는 것을 알 수 있습니다.

``` bash
~# vi /etc/yum.repos.d/Rocky-Extras.repo
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-07.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}

### 리포지토리 설정 - 정상 서버
그렇다면 아무 문제 없는 정상적인 서버의 경우는 어떤지 비교해서 살펴보겠습니다.  

마찬가지로 [**/etc/yum.repos.d/**] 디렉토리에 있는 리포지토리 설정 파일을 확인해보면 오류가 발생한 서버와 달리 아래와 같이 [**Rocky-AppStream.repo**], [**Rocky-BaseOS.repo**] 이렇게 2가지 파일만 존재하는 것을 확인할 수 있습니다.

``` bash
~# ls -al /etc/yum.repos.d/
```
{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-03.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}

- 또한 2가지 설정 파일들 중에서 [**Rocky-AppStream.repo**] 파일을 열어서 미러 사이트 주소를 확인해보면, 록키 리눅스 공식 사이트는 주석 처리가 되어 있고, [**baseurl**]이 [**repo.ncloud.com**] 이라는 Ncloud 내부 서버로 설정되어 있는 것을 알 수 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-04.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}


### 원인 추적
오류가 발생한 서버와 정상적인 서버의 차이점을 비교 추적해보니 오류가 발생한 서버에서는 서버 생성 후에 `패키지 업데이트`가 진행된 것을 알 수 있었습니다. 
서버 생성 후에 설치된 패키지들의 업데이트를 적용하기 위해 [**dnf upgrade**]를 실행했고, 그에 따라 리포지토리 정보가 변경되었다는 것을 알 수 있었습니다.

``` bash
~# dnf -y upgrade
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-05.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}


{% include callout-v2.html type=&quot;info&quot; level=&quot;2&quot; content=&quot;
[**dnf upgrade**]와 [**dnf update**]의 차이점에 대해 [**man dnf**] 명령어로 매뉴얼을 살펴보면 Rocky Linux에서 패키지 업데이트를 위한 기본 명령어는 [**dnf upgrade**]이며, [**dnf update**]는 더 이상 사용되지 않는 별칭이라고 합니다.
&quot; %}

``` bash
~# man dnf
#--- 중략 ---#
Upgrade Command
       Command: upgrade
       Aliases: up
       Deprecated aliases: update, upgrade-to, update-to, localupdate
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-11.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}


## 해결 방법
이 문제를 해결하는 방법은 몇가지가 있는데 차례대로 정리해보겠습니다.

### 방법-1
첫번째 방법은 [**Rocky-Extras.repo**] 리포지토리 설정파일의 주소를 Ncloud 내부 서버로 변경하는 방법입니다.

``` conf
# Rocky-Extras.repo

#mirrorlist=https://mirrors.rockylinux.org/mirrorlist?arch=$basearch&amp;repo=AppStream-$releasever
baseurl=http://repo.ncloud.com/rocky/$releasever/extras/$basearch/os/
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-08.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}

- 주소를 변경 후에 아파치를 설치해보면 문제 없이 잘 설치 되는 것을 확인할 수 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-09.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}


### 방법-2
두번째 방법은 패키지를 설치할 때 미러 사이트 주소가 변경된 [**Extras**] 저장소를 비활성화하는 옵션을 적용하는 방법입니다.

``` bash
~# dnf -y install httpd --disablerepo=extras
```
{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-10.png&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}

## 사전 예방책
위 방법들은 패키지 업데이트 후에 문제를 해결하는 방법이므로, 사전에 이런 문제가 생기지 않도록 하는 것도 선택지 중의 하나입니다. 가능한 방법은 다음 2가지 입니다.
- 패키지 업데이트를 진행하지 않는 방법
- 보안-버그 수정 사항만 최소한으로 업데이트 하는 방법

### 패키지 최소 업데이트
보안-버그 수정 사항만 최소한으로 업데이트 하는 [**upgrade-minimal**] 옵션으로 업데이트를 했을 경우에는 아래와 같이 리포지토리 파일에 변화가 없어서 이후 패키지 설치에 오류가 생기지 않습니다.

``` bash
~# dnf -y upgrade-minimal
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-12.png&quot; width=&quot;840&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-13.png&quot; sub-class=&quot;docimage-no-top&quot; width=&quot;840&quot; alt=&quot;Ncloud (네이버 클라우드) Rocky Linux 서버 리포지토리 미러 사이트 오류 문제 해결 방법&quot; caption=&quot;&quot; %}


## 참고 URL
1.  Rocky Linux 서버 소개
	- &lt;a href=&quot;/compute/ncloud-compute-server-rocky-linux-guide.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/compute/ncloud-compute-server-rocky-linux-guide.html&lt;/a&gt;

2.  Rocky Linux 미러 사이트 리스트
	- &lt;a href=&quot;https://mirrors.rockylinux.org/mirrormanager/mirrors/Rocky&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://mirrors.rockylinux.org/mirrormanager/mirrors/Rocky&lt;/a&gt;
</description>
            <pubDate>Thu, 29 Jun 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-troubleshooting.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/compute/ncloud-compute-server-rocky-linux-repository-mirror-site-error-troubleshooting.html</guid>
            
            <category>linux</category>
            
            <category>rocky_linux</category>
            
            
        </item>
        
        <item>
            <title>Ncloud에서 제공하는 록키 리눅스(Rocky Linux) 서버 소개</title>
            <description>## 개요
Rocky Linux (록키 리눅스)는 CentOS의 서비스 지원 종료로 대안으로 떠오른 CentOS 기반의 리눅스 OS입니다.  
Ncloud (네이버 클라우드)는 이 록키 리눅스의 핵심 파트너로 선정되어 국내에서 록키 리눅스 인프라와 기술지원을 위해 협력해왔고, 드디어 Ncloud 콘솔에서 록키 리눅스를 제공하기 시작했기에 간단하게 소개해보려고 합니다.

## 제공 버전
Ncloud에서는 현재 Rocky Linux 8.6 버전을 VPC 환경에서 제공하고 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-01.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

## 설치할 소프트웨어
록키 리눅스 서버를 실행하고 보통 자주 사용하게 되는 아래의 소프트웨어들을 설치하고 확인해보겠습니다.
- Apache
- PHP
- NGINX
- MariaDB (MySQL)

## 접속 화면
서버를 생성하고 접속하면 아래와 같이 Ncloud 로고가 크게 표시된 화면을 볼 수 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-02.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

## 패키지 업데이트
우선 패키지 관련한 보안-버그 수정 사항만 최소한으로 업데이트를 해보겠습니다.

``` bash
~# dnf -y upgrade-minimal
```
{% include note.html title=&quot;dnf&quot; content=&quot;Dandified YUM의 약자인 dnf는 기존의 yum 패키지 관리자가 갖고 있던 여러 단점들을 수정, 업그레이드해서 
Fedora 18 이후 버전에서 사용되고 있으며, Rocky Linux도 마찬가지로 dnf를 기본 패키지 관리자로 사용하고 있습니다. 물론 호환성을 위해서 yum 명령어도 사용할 수 있습니다.
&quot; %}

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-03.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

## Apache, PHP 설치
설치할 소프트웨어 중에서 Apache와 PHP를 동시에 설치해보겠습니다.  

``` bash
~# dnf -y install httpd php
```

설치된 버전은 다음과 같습니다.
- Apache: 2.4.37
- PHP: 7.2.24

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-05.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### 접속화면
설치 완료 후에 웹브라우저로 접속해보면 다음과 같이 Apache 로고가 포함된 화면을 확인할 수 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-06.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### PHP 버전 리스트
Ncloud Rocky Linux 8.6에서 지원하는 PHP 버전은 다음과 같이 확인해볼 수 있습니다.  
리스트를 확인해보면 7.2버전이 기본이고, 현재 활성화된 버전도 7.2버전인 것을 알 수 있습니다.

``` bash
~# dnf module list php
```

- PHP 7.2 (default)
- PHP 7.3
- PHP 7.4
- PHP 8.0

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-19.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

## PHP 버전 변경
기본으로 설치된 **7.2** 버전에서 다른 버전으로 변경하는 방법에 대해 알아보겠습니다. 여기서는 **8.0**으로 변경해보겠습니다.

### 버전 활성화 정보 초기화
우선 위에서 확인했던 php 버전 활성화 정보를 초기화 합니다.

``` bash
~# dnf module reset php
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-20.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}


### PHP 8.0 활성화
다음으로 8.0 버전을 활성화 합니다.

``` bash
~# dnf module enable php:8.0
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-21.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### PHP 8.0 설치
마지막으로 8.0 버전을 설치하고 버전을 확인해봅니다.

``` bash
~# dnf -y install php
~# php -v
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-22.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

## NginX 설치
다음으로 NginX 최신버전(mainline)으로 설치해보겠습니다.  
NginX 최신버전(mainline)을 설치하기 위해서는 epel-release 리포지토리 패키지가 필요하고, epel-release 리포지토리 패키지를 설치하기 위해서는 Extras 저장소 설정 파일이 필요합니다.

### 리포지토리 설정 파일 추가
우선, Extras 저장소 설정 파일 준비합니다. 이미 생성되어 있는 경우에는 다음 단계로 넘어가도 되고, 그렇지 않을 경우 아래와 같은 내용으로 파일을 생성합니다.

``` bash
~# vi /etc/yum.repos.d/Rocky-Extras.repo
```

``` conf
# Rocky-Extras.repo

[extras]
name=Rocky Linux $releasever - Extras
#mirrorlist=https://mirrors.rockylinux.org/mirrorlist?arch=$basearch&amp;repo=extras-$releasever
baseurl=http://repo.ncloud.com/rocky/$releasever/extras/$basearch/os/
gpgcheck=1
enabled=1
countme=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-rockyofficial
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-28.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### EPEL 리포지토리 패키지 설치
다음으로, NginX 최신 버전을 설치하기 위해 epel-release 리포지토리 패키지를 설치하겠습니다.

``` bash
~# dnf -y install epel-release
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-04.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### NginX 버전 리스트
위 준비사항이 모두 완료되었으면, Ncloud Rocky Linux 8.6에서 지원하는 NginX 버전을 확인합니다.  
리스트를 살펴보면 1.14가 기본 버전이고, 현재 활성화된 버전도 1.14인 것을 알 수 있습니다.

``` bash
~# dnf module list nginx
```

- nginx 1.14 (default)
- nginx 1.16
- nginx 1.18
- nginx 1.20
- nginx mainline

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-23.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### 버전 활성화 정보 초기화
우선 위에서 확인했던 nginx 버전 활성화 정보를 초기화 합니다.  
혹시 활성화된 버전이 없을 경우에는 별다른 변화 없이 과정이 완료됩니다.

``` bash
~# dnf module reset nginx
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-24.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### mainline 버전 활성화
최신 버전인 mainline 버전을 활성화합니다.

``` bash
~# dnf module enable nginx:mainline
```
{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-07.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### 설치
NginX 설치합니다. 설치된 버전은 다음과 같습니다.

``` bash
~# dnf -y install nginx
~# nginx -v
```
- NGINX: 1.23.1

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-08.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### 접속화면
설치 완료 후에 nginx를 실행 시키고, 웹브라우저로 접속해보면 다음과 같이 NGINX 로고가 포함된 화면을 확인할 수 있습니다.

``` bash
~# systemctl enable nginx
~# systemctl start nginx
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-09.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

## MariaDB (MySQL) 설치

### MariaDB 버전 리스트
우선, Ncloud Rocky Linux 8.6에서 지원하는 MariaDB 버전을 확인합니다.  
리스트를 살펴보면 10.3이 기본 버전인 것을 알 수 있습니다.

``` bash
~# dnf module list mariadb
```

- mariadb 10.3 (default)
- mariadb 10.5

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-27.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### 설치
Rocky Linux에서는 기본 DB가 MariaDB이고, 설치할 때도 [**mariadb-server**]로 설치하게 됩니다.  
여기서는 기본 버전으로 설치하겠습니다.

``` bash
~# dnf -y install mariadb-server
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-12.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

MariaDB 데몬을 시작합니다.  
그런데 자세히 보시면 생성된 symlink가 [**mysql.service**]인 것을 확인할 수 있습니다. 즉, MariaDB를 실행할 때는 [**mysql**] 명령을 입력하면 된다는 뜻입니다.

``` bash
~# systemctl enable mariadb
~# systemctl start mariadb
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-13.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### DB 접속
[**mysql**] 명령을 입력하면 아래와 같이 MariaDB 서버에 접속됩니다.  
설치된 DB 서버 버전은 다음과 같습니다.
- MariaDB: 10.3.32

``` bash
~# mysql
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-14.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}


## 웹 콘솔
Rocky Linux는 웹브라우저에서 서버에 접속해서 서버를 관리할 수 있는 웹 콘솔을 제공하는데, 처음 서버에 접속했던 콘솔화면을 보면 아래와 같이 웹 콘솔을 활성화하는 방법이 안내되어 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-15.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

아래 명령어를 입력하면 [**9090**] 포트로 접속할 수 있는 웹 콘솔이 활성화됩니다.
``` bash
~# systemctl enable --now cockpit.socket
```
{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-16.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### 웹 콘솔 접속
먼저, ACG에서 [**9090**] 포트를 오픈하고, [**https://{서버 IP}:9090**]으로 접속하면 아래와 같은 화면을 볼 수 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-17.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### 웹 콘솔 화면
웹 콘솔에 접속하면 서버 상태와 시스템 정보, CPU-메모리 사용량 등을 확인할 수 있고, 그 외에도 여러 가지 기능을 확인할 수 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-18.png&quot; width=&quot;845&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}


## 버전 활성화 오류 해결 방법
[dnf module enable &lt;module_name&gt;] 명령으로 다른 버전을 활성화하려고 할 때 아래와 같은 오류가 발생하는 경우가 있습니다.  
오류 메시지 하단에 보면 [**dnf module reset &lt;module_name&gt;**] 명령을 입력하면 해결된다 합니다.

{% include warning.html title=&quot;Error&quot; content=&quot;It is not possible to switch enabled streams of a module unless explicitly enabled via configuration option module_stream_switch. 
It is recommended to rather remove all installed content from the module, and reset the module using &apos;**dnf module reset \&lt;module_name\&gt;**&apos; command. After you reset the module, you can install the other stream.
&quot; %}

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-25.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-10.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}


명령을 입력하고 처리가 완료되면 [**dnf module enable \&lt;module_name\&gt;:\&lt;module_version\&gt;**] 명령을 다시 입력하면 됩니다.
``` bash
#예시
~# dnf module reset php
~# dnf module reset nginx
```
{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-26.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-11.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}


## 참고 URL
1.  Rocky Linux 공식 가이드
	- &lt;a href=&quot;https://docs.rockylinux.org/guides/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.rockylinux.org/guides/&lt;/a&gt;

2.  Rocky Linux Apache 설정
	- &lt;a href=&quot;https://docs.rockylinux.org/guides/web/apache-sites-enabled/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.rockylinux.org/guides/web/apache-sites-enabled/&lt;/a&gt;

2.  Rocky Linux NGINX 설정
	- &lt;a href=&quot;https://docs.rockylinux.org/guides/web/nginx-multisite/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.rockylinux.org/guides/web/nginx-multisite/&lt;/a&gt;

2.  Rocky Linux MariaDB 설치
	- &lt;a href=&quot;https://docs.rockylinux.org/guides/database/database_mariadb-server/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.rockylinux.org/guides/database/database_mariadb-server/&lt;/a&gt;		
</description>
            <pubDate>Thu, 29 Jun 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/compute/ncloud-compute-server-rocky-linux-guide.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/compute/ncloud-compute-server-rocky-linux-guide.html</guid>
            
            <category>linux</category>
            
            <category>apache</category>
            
            <category>php</category>
            
            <category>nginx</category>
            
            <category>mysql</category>
            
            <category>mariadb</category>
            
            <category>rocky_linux</category>
            
            
        </item>
        
        <item>
            <title>Rocky Linux에서 NginX 설치, 설정하는 방법</title>
            <description>## 개요
Ncloud (네이버 클라우드) Rocky Linux (록키 리눅스) 서버에 NginX 최신 버전을 Package로 설치하고 기본 설정을 하는 방법에 대한 내용을 정리해보겠습니다.  


## 서버 환경

{% include callout_v2.html type=&quot;secondary&quot; level=&quot;2&quot; content=&quot;
&amp;#8259; OS: Rocky Linux 8.6 &lt;br /&gt;
&amp;#8259; NginX: NginX 1.23.1 &lt;br /&gt; 
&amp;#8259; 테스트 사이트: nginx-test.com
&quot; %}

## 서버 준비
Ncloud 콘솔에서 Rocky Linux 8.6 서버를 아래와 같이 준비했습니다.

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-01.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 설치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

## 패키지 업데이트
우선 패키지 관련한 보안-버그 수정 사항만 최소한으로 업데이트를 해보겠습니다.

``` bash
~# dnf -y upgrade-minimal
```
{% include note.html title=&quot;dnf&quot; content=&quot;Dandified YUM의 약자인 dnf는 기존의 yum 패키지 관리자가 갖고 있던 여러 단점들을 수정, 업그레이드해서 
Fedora 18 이후 버전에서 사용되고 있으며, Rocky Linux도 마찬가지로 dnf를 기본 패키지 관리자로 사용하고 있습니다. 물론 호환성을 위해서 yum 명령어도 사용할 수 있습니다.
&quot; %}

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-03.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

### 리포지토리 설정 파일 추가
NginX 최신버전(mainline)을 설치하기 위해서는 epel-release 리포지토리 패키지가 필요하고, epel-release 리포지토리 패키지를 설치하기 위해서는 Extras 저장소 설정 파일이 필요합니다.  
우선, Extras 저장소 설정 파일을 준비합니다. 이미 생성되어 있는 경우에는 다음 단계로 넘어가도 되고, 그렇지 않을 경우 아래와 같은 내용으로 파일을 생성합니다.

``` bash
~# vi /etc/yum.repos.d/Rocky-Extras.repo
```

``` conf
# Rocky-Extras.repo

[extras]
name=Rocky Linux $releasever - Extras
#mirrorlist=https://mirrors.rockylinux.org/mirrorlist?arch=$basearch&amp;repo=extras-$releasever
baseurl=http://repo.ncloud.com/rocky/$releasever/extras/$basearch/os/
gpgcheck=1
enabled=1
countme=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-rockyofficial
```

{% include image.html file=&quot;compute/ncloud-compute-server-rocky-linux-guide-28.png&quot; width=&quot;840&quot; alt=&quot;Ncloud(네이버 클라우드)에서 제공하기 시작한 록키 리눅스 소개&quot; caption=&quot;&quot; %}

## EPEL 저장소 패키지 설치
다음으로 epel-release 저장소 패키지를 설치하겠습니다.

``` bash
~# dnf -y install epel-release
```

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-03.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

## NginX 버전 선택
설치할 NginX 버전 버전을 선택합니다.

### NginX 버전 리스트
우선, Ncloud Rocky Linux 8.6에서 지원하는 NginX 버전을 확인합니다.  
리스트를 살펴보면 1.14가 기본 버전인 것을 알 수 있습니다.

``` bash
~# dnf module list nginx
```

- nginx 1.14 (default)
- nginx 1.16
- nginx 1.18
- nginx 1.20
- nginx mainline

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-04.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

### 버전 활성화 정보 초기화
다음으로 위에서 확인했던 nginx 버전 활성화 정보를 초기화 합니다. 현재 활성화 된 버전이 존재하느냐에 따라 나타나는 메시지가 다릅니다.

``` bash
~# dnf module reset nginx
```

- 활성화 된 버전이 없을 때
{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-05.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

- 활성화 된 버전이 있을 때
{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-15.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

### mainline 버전 활성화
최신 버전인 mainline 버전을 활성화합니다.

``` bash
~# dnf module enable nginx:mainline
```

{% include callout_v2.html type=&quot;info&quot; level=&quot;2&quot; content=&quot;NginX는 stable, mainline 두가지 버전이 있습니다. 
NginX의 공식 설명에 따르면 버그 수정이나 보안 패치 등은 항상 mainline 버전에 먼저 적용되기 때문에 mainline을 사용하는 것을 추천한다고 합니다. &lt;br /&gt;
stable 버전을 사용하는 주된 경우는 **third-party 모듈**을 사용하고 있어서 신규 버전에서 **호환성 문제**가 발생할 가능성이 걱정될 때라고 합니다.&quot; %}

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-06.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}


## NginX 설치
NginX를 설치합니다. 설치된 버전은 다음과 같습니다.

``` bash
~# dnf -y install nginx
~# nginx -v
```
- NginX: 1.23.1

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-07.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

## 디렉토리 설정
다음으로 홈으로 사용할 디렉토리를 생성하고, 해당 디렉토리의 소유권을 설정하겠습니다.  
그리고, NginX가 정상 작동하는지 확인해보기 위해 설치시에 포함된 index.html을 포함한 파일들을 홈 디렉토리로 복사합니다.

``` bash
# 테스트 사이트 홈 디렉토리 생성
~# mkdir -p /ncloud/data/www/nginx-test/

# 해당 디렉토리에 nginx에 권한 부여
~# chown -R nginx:nginx /ncloud/data/www/nginx-test

# nginx 샘플 페이지를 사이트 디렉토리로 복사
~# cp /usr/share/nginx/html/*.* /ncloud/data/www/nginx-test/

# 복사된 파일들 확인
~# ls -al /ncloud/data/www/nginx-test/
```
{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-08.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}



## 환경 설정

### 설정 파일 위치
NginX 환경 설정 파일의 위치는 **/etc/nginx/** 디렉토리입니다. **tree** 명령으로 해당 디렉토리에서 **conf**와 관련된 파일 리스트와 디렉토리 구조를 확인하면 다음과 같습니다.

``` bash
~# tree -P *conf* /etc/nginx/
```

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-16.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

### 기본 설정 파일
위에서 확인할 수 있는 파일들 중에서 기본 환경 설정 파일은 **/etc/nginx/nginx.conf** 입니다.  
**nginx.conf** 파일을 열어보면 아래와 같이 **server {...}**로 시작되는 사이트 설정에 관련된 부분도 있지만,  
**include /etc/nginx/conf.d/*.conf** 와 같이 **conf.d** 디렉토리에 있는 설정 파일을 모두 불러오도록 되어 있습니다.  

물론, 사이트 설정을 **nginx.conf** 파일에 직접 설정해도 되지만, 여러 개의 사이트를 설정해야 하는 경우도 생각해서 **conf.d 디렉토리**에 사이트 이름별로 환경 설정 파일을 별도로 만들어서 진행하도록 하겠습니다. 

``` bash
~# vi /etc/nginx/nginx.conf
```

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-09.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

### 기본 설정 주석 처리
**server {...}** 부분을 모두 주석 처리합니다.

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-10.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

### 환경 설정 파일 생성
**nginx-test.com** 이라는 도메인의 사이트 설정을 **nginx-test.conf** 설정 파일을 생성해서 저장합니다.

``` bash
~# vi /etc/nginx/conf.d/nginx-test.conf
```

``` nginx
  server {
    listen    80;
    listen    [::]:80;

    # 사이트 도메인 설정
    server_name    nginx-test.com www.nginx-test.com;

    # 홈 디렉토리, 기본 문서 설정
    root      /ncloud/data/www/nginx-test;
    index     index.html index.htm;

    # 404 error 페이지 설정
    error_page 404 /404.html;
      location = /404.html {
    }

    # 50x error 페이지 설정
    error_page 500 502 503 504 /50x.html;
      location = /50x.html {
      root    /ncloud/data/www/nginx-test;
    }

    # .htaccess 파일 접근 금지 설정
    location ~ /\.ht {
      deny    all;
    }
}
```

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-11.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}


## NginX 실행
설정을 모두 마쳤으면 NginX를 시작하고 상태를 확인합니다.

``` bash
~# systemctl enable nginx
~# systemctl start nginx
~# systemctl status nginx
```
{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-12.png&quot; width=&quot;840&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

## hosts 파일 수정
지금과 같이 테스트용으로 임의 설정한 도메인(**nginx-test.com**)으로 접속하게 될 경우에는 hosts 파일을 수정해야 합니다.  
`실제 도메인을 사용할 경우에는 아래 과정이 필요 없기에` [다음 단계로 바로 이동&lt;i class=&quot;fa-solid fa-turn-down&quot;&gt;&lt;/i&gt;](#https-access-test)하시면 됩니다. 

윈도우 10에서 hosts 파일은 C:\Windows\System32\drivers\etc 에 존재하는데 직접 수정할 수가 없으므로 다음과 같은 단계를 거쳐야 합니다.

1. C:\Windows\System32\drivers\etc\hosts 파일을 임의의 작업 폴더 (예: D:\Work)로 복사합니다.
2. 복사한 hosts 파일을 수정해서 123.456.789.123 nginx-test.com 처럼 접속할 IP 주소와 도메인을 추가합니다.
3. 수정한 파일을 C:\Windows\System32\drivers\etc 위치로 덮어쓰기 합니다.
4. 덮어쓰기 할 때 관리자 권한이 필요하다는 안내 메시지가 나타나면 [계속] 버튼을 클릭합니다.

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-14.png&quot; width=&quot;745&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-ssl-setting-guide-centos-05.png&quot; width=&quot;710&quot; alt=&quot;Ncloud CentOS 서버에 NginX SSL 인증서를 설정하는 방법&quot; caption=&quot;&quot; %}

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-ssl-setting-guide-centos-06.png&quot; width=&quot;710&quot; alt=&quot;Ncloud CentOS 서버에 NginX SSL 인증서를 설정하는 방법&quot; caption=&quot;&quot; %}


## 사이트 접속 {#https-access-test}
NginX가 정상 작동하면 아래와 같이 서버 접속 화면을 확인할 수 있습니다.

{% include image.html file=&quot;compute/lemp/ncloud-server-nginx-install-setting-guide-rocky-linux-13.png&quot; width=&quot;845&quot; alt=&quot;Ncloud Rocky Linux 서버에 NginX를 Package로 치하고 기본 설정을 하는 방법&quot; caption=&quot;&quot; %}


## 참고 URL
1.  Rocky Linux NginX 설치 기본 가이드
	- &lt;a href=&quot;https://docs.rockylinux.org/guides/web/nginx-mainline/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.rockylinux.org/guides/web/nginx-mainline/&lt;/a&gt;

2.  Rocky Linux NginX Multi Site 설치 가이드
	- &lt;a href=&quot;https://docs.rockylinux.org/guides/web/nginx-multisite/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.rockylinux.org/guides/web/nginx-multisite/&lt;/a&gt;</description>
            <pubDate>Thu, 29 Jun 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/compute/ncloud-compute-lemp-nginx-install-setting-rocky-linux-guide.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/compute/ncloud-compute-lemp-nginx-install-setting-rocky-linux-guide.html</guid>
            
            <category>rocky_linux</category>
            
            <category>lemp</category>
            
            <category>nginx</category>
            
            <category>install</category>
            
            
        </item>
        
        <item>
            <title>Ncloud VPC 환경에서 무료 서버(Micro Type) 이용하는 방법</title>
            <description>## 개요 
Ncloud (네이버 클라우드)는 체험 및 테스트 용도로 **최초 결제 수단 등록 월부터 1년간 무료**로 사용할 수 있는 Micro 타입 서버를 제공하고 있습니다. 전에는 Classic 환경에서만 이용할 수 있었는데, 최근 업데이트 이후 VPC 환경에서도 이용할 수 있게 되었기에, VPC 환경에서 무료 서버인 Micro 타입 서버를 생성하는 과정을 정리해보겠습니다.

## Micro 타입 서버 특징
- 스펙: vCPU 1개, 메모리 1GB
- `계정당 1대`만 이용 가능
- 체험용으로 가용성 및 성능 보장 불가
- 거주지 국가가 한국인 경우만 제공
- `신규 가입 후 최초 결제 수단 등록 월부터 1년간 무료` 제공, 1년이 지나면 **월요금제**로 과금
- 최초 결제 수단 등록 월은 포털 마이페이지 &gt; 결제수단 관리에서 확인
- Network Interface는 1개만 이용 가능
- 3세대(g3) 서버로 **KVM** 하이퍼바이저 기반의 서버만 제공
- 기본 스토리지는 **10 GB까지만 무료**이며, 용량을 늘리거나 추가하는 스토리지의 경우 유료 과금


## 서버 생성
[**VPC**] 환경에서 서버(Server)를 생성하려면 사전에 [**VPC**]와 [**Subnet**]이 생성되어 있어야 하는데, 혹시 처음 [**VPC**] 환경에 접속하셔서 [**VPC**]와 [**Subnet**]이 존재하지 않는 경우는 아래 문서를 보고 미리 생성하고 오셔야 합니다.

{% include callout-v2.html type=&quot;info&quot; level=&quot;2&quot; content=&quot;
&lt;a href=&apos;/compute/ncloud_compute_server_vpc_create.html&apos; target=&apos;_blank&apos; style=&apos;word-break:break-all;&apos;&gt;VPC 환경에서 서버 생성하는 방법 (VPC, Subnet 생성 포함)&lt;/a&gt;
&quot; %}

## Server 서비스 위치
[**Server**] 서비스는 [**Console**] - [**Services**] - [**Compute**]에 위치해 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-vpc-server-create-guide-01.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud VPC 환경에서 서버를 생성하는 방법&quot; caption=&quot;&quot; %}

- [**Server**] - [**Server**]에서 [**서버 생성**] 버튼을 클릭합니다.

{% include image.html file=&quot;compute/ncloud-compute-vpc-server-create-guide-02.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud VPC 환경에서 서버를 생성하는 방법&quot; caption=&quot;&quot; %}

## 서버 생성 콘솔 선택
Ncloud 서버 생성 콘솔화면은 신규 기능이 업데이트 되면서 2가지를 선택할 수 있습니다. Micro 타입 서버는 **KVM** 하이퍼바이저 기반의 서버이므로  [**신규 콘솔 화면**]으로 진행하겠습니다.

- 기존 콘솔 화면: **XEN, RHV** 하이퍼바이저 기반의 서버(g1,g2)를 생성할 수 있습니다.
- 신규 콘솔 화면: **XEN, RHV** 하이퍼바이저 기반의 서버(g1,g2)뿐만 아니라 **KVM** 기반 및 다양한 성능을 제공하는 기본 스토리지로 서버(**g3**)를 생성할 수 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-vpc-server-create-guide-03.png&quot; width=&quot;685&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud VPC 환경에서 서버를 생성하는 방법&quot; caption=&quot;&quot; %}

## 서버 이미지 선택
Micro 타입 서버를 생성하려면 하이퍼바이저 기준으로 [**KVM**] 서버 이미지를 선택하면 됩니다. 현재 Ncloud에서 제공되는 [**KVM**] 서버 이미지는 아래와 같이 [**CentOS 7.8**], [**Ubuntu 20.04**] 이렇게 2가지 입니다. 여기서는 Ubuntu 20.04로 생성해보겠습니다.

{% include image.html file=&quot;compute/ncloud-compute-micro-type-server-create-vpc-guide-01.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud (네이버 클라우드) VPC 환경에서 무료 서버(Micro Type) 이용하는 방법&quot; caption=&quot;&quot; %}

## 서버 설정
서버 설정 단계에서는 [**VPC**]와 [**Subnet**]을 선택하고  [**서버 스펙**]과 [**요금제**], [**Network Interface**], [**공인 IP 할당 여부**] 등을 선택하게 됩니다. `서버는 1년간 무료이지만, 공인 IP를 할당하게 되면 공인 IP 비용이 청구됩니다.`

{% include image.html file=&quot;compute/ncloud-compute-micro-type-server-create-vpc-guide-02.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud (네이버 클라우드) VPC 환경에서 무료 서버(Micro Type) 이용하는 방법&quot; caption=&quot;&quot; %}

## 스토리지 설정
KVM 하이퍼바이저 기반인 Micro 타입서버는 기본 스토리지 10GB까지만 무료로 제공되며, 용량을 늘릴 경우 비용이 발생합니다.

{% include image.html file=&quot;compute/ncloud-compute-micro-type-server-create-vpc-guide-03.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud (네이버 클라우드) VPC 환경에서 무료 서버(Micro Type) 이용하는 방법&quot; caption=&quot;&quot; %}

## 인증키 설정
인증키 이름을 입력하고, [**인증키 생성 및 저장**] 버튼을 클릭해서 인증키를 로컬 PC에 다운로드 받아서 안전한 곳에 보관해야 합니다. 기존에 사용하고 있던 인증키가 있을 경우에는 [**보유하고 있는 인증키 이용**]을 선택하면 됩니다.

{% include warning.html title=&quot;인증키&quot; content=&quot;인증키는 해당 서버의 **관리자 비밀번호**를 확인하는데 사용되므로 **안전한 곳에 잘 보관**해야 합니다.&quot; %}

{% include image.html file=&quot;compute/ncloud-compute-vpc-server-create-guide-20.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-top-bottom&quot; alt=&quot;Ncloud VPC 환경에서 서버를 생성하는 방법&quot; caption=&quot;&quot; %}

## 네트워크 접근 설정
네트워크 접근은 [**ACG**]로 설정하게 되는데, `ACG(Access Control Group)는 서버 간 네트워크 접근 제어 및 관리를 할 수 있는 IP/Port 기반 필터링 방화벽 서비스`로, 서버에 별도의 복잡한 방화벽 구축없이 간단하게 서버에 대한 네트워크 접근 제어를 할 수 있습니다.  
[**VPC**]를 생성하면 자동으로 생성되는 **기본 ACG**를 선택하거나 별도로 생성한 ACG가 있을 경우 해당 ACG를 선택하면 됩니다. **적용할 ACG는 최대 3개**까지 선택할 수 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-micro-type-server-create-vpc-guide-04.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud (네이버 클라우드) VPC 환경에서 무료 서버(Micro Type) 이용하는 방법&quot; caption=&quot;&quot; %}

## 서버 생성 완료
모든 단계를 마치고 나면 아래와 같이 서버가 생성된 것을 확인할 수 있습니다.

{% include image.html file=&quot;compute/ncloud-compute-micro-type-server-create-vpc-guide-05.png&quot; width=&quot;845&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud (네이버 클라우드) VPC 환경에서 무료 서버(Micro Type) 이용하는 방법&quot; caption=&quot;&quot; %}

## 서버 접속
생성된 서버에 접속해서 vCPU와 Memory 상태를 확인해보면 다음과 같습니다.

``` bash
~# grep -c processor /proc/cpuinfo
~# free
```

{% include image.html file=&quot;compute/ncloud-compute-micro-type-server-create-vpc-guide-06.png&quot; width=&quot;840&quot; sub-class=&quot;docimage-no-bottom&quot; alt=&quot;Ncloud (네이버 클라우드) VPC 환경에서 무료 서버(Micro Type) 이용하는 방법&quot; caption=&quot;&quot; %}


## 참고 URL
1.  Ncloud 서버 접속 가이드
	- &lt;a href=&quot;https://guide.ncloud-docs.com/docs/server-access-vpc&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://guide.ncloud-docs.com/docs/server-access-vpc&lt;/a&gt;

2.  Ncloud 서버 인증키 변경하는 방법
	- &lt;a href=&quot;/compute/ncloud-compute-server-change-authentication-key.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/compute/ncloud-compute-server-change-authentication-key.html&lt;/a&gt;
</description>
            <pubDate>Wed, 21 Jun 2023 00:00:00 +0900</pubDate>
            <link>https://docs.3rdeyesys.com/compute/ncloud-compute-micro-type-server-create-vpc.html</link>
            <guid isPermaLink="true">https://docs.3rdeyesys.com/compute/ncloud-compute-micro-type-server-create-vpc.html</guid>
            
            <category>linux</category>
            
            <category>vpc</category>
            
            
        </item>
        
    </channel>
</rss>
